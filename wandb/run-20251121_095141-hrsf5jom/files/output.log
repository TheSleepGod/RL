==================== Loading Models ====================
ModelManager initialized with base model path: /opt/tiger/model/Qwen2-7B
--- Loading and merging LoRA adapter using ModelManager ---
--- Method 1: Merging LoRA to model in memory ---
Loading base model from: /opt/tiger/model/Qwen2-7B
`torch_dtype` is deprecated! Use `dtype` instead!
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████| 4/4 [00:02<00:00,  1.39it/s]
Loading LoRA adapter from: out/sft_qwen2_7b/final
Merging LoRA weights into the base model...
✅ Merge complete.
Wrapping loaded models with Value Head for PPO...
✅ Models wrapped successfully.
==========================================================

==================== Preparing Data ====================
[PPODataProcessor] Report for: /mnt/bn/search-nlp-us/haohanwen/haohw/data/all_data/gsm8k_train.jsonl
  - Total records read: 7473
  - Records processed (valid prompts): 7473
  - Prompts truncated due to overlength: 0
==========================================================
Initializing PPOTrainer...
[rank1]: Traceback (most recent call last):
[rank1]:   File "/mnt/bn/search-nlp-us/haohanwen/haohw/rl/train_ppo.py", line 165, in <module>
[rank1]:     main()
[rank1]:   File "/mnt/bn/search-nlp-us/haohanwen/haohw/rl/train_ppo.py", line 93, in main
[rank1]:     ppo_trainer = PPOTrainer(
[rank1]:                   ^^^^^^^^^^^
[rank1]: TypeError: PPOTrainer.__init__() got an unexpected keyword argument 'lam'
